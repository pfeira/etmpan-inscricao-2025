<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Inscrição Campeonato ETMPAN</title>

    <link rel="stylesheet" href="style.css">

</head>
<body>
    <div class="card">
    
      	<div class="card-image">
          	<img src="etmpan.png" alt="Campeonato ETMPAN" id="poster-campeonato">
  	</div>
    
      	<div class="card-content">
    	<div class="card-header">
      	<a href="como-se-inscrever.html" class="header-btn">COMO SE INSCREVER</a>
      	<a href="regulamento.html" class="header-btn">REGULAMENTO</a>
    	</div>
    	<div class="form-container">
      	<form id="formInscricao">
        	<div class="box">
          	<input type="text" name="nome" placeholder="Nome" required>
          	<input type="text" name="sobrenome" placeholder="Sobrenome" required>
        	</div>
        	<div class="box divisoes">
          	<p style="margin:0 0 10px 0; font-size: 0.9em; color: #555;">Escolha até duas divisões:</p>
          	<label><input type="checkbox" name="divisao" value="1ª Divisão"> 1ª Divisão</label>
          	<label><input type="checkbox" name="divisao" value="2ª Divisão"> 2ª Divisão</label>
          	<label><input type="checkbox" name="divisao" value="3ª Divisão"> 3ª Divisão</label>
                      	<label><input type="checkbox" name="divisao" value="TOP12"> TOP12</label> 
        	</div>
        	<button type="submit">Enviar Inscrição</button>
      	</form>
      	<div id="mensagem" class="msg"></div>
      	<div class="valores">
        	<h3>VALORES</h3>
        	<div class="valores-container">
          	<div class="valor-box"><h4>Estudante</h4><p>R$ 20</p></div>
          	<div class="valor-box"><h4>Sócio</h4><p>01 DIV R$ 25<br>02 DIV R$ 30</p></div>
          	<div class="valor-box"><h4>Não Sócio</h4><p>01 DIV R$ 40<br>02 DIV R$ 60</p></div>
                      	<div class="valor-box"><h4>TOP12</h4><p>R$ 40</p></div>
        	</div>
        	<div class="pix">PIX ÂNGELO NETO: 71-99935-3004</div>
      	</div>
    	</div>
  	</div>
  </div>

    <script>
  	const scriptURL = "https://script.google.com/macros/s/AKfycbzq3J50mZmaHq97t8f0sGLRKF14856umOr9_0W5JGTPx7UKe3d8lDz7kbnp07ypMAMz/exec";
  	const form = document.getElementById("formInscricao");
  	const msgBox = document.getElementById("mensagem");
  	form.addEventListener("submit", e => {
    	e.preventDefault();
    	const divisoesSelecionadas = document.querySelectorAll('input[name="divisao"]:checked').length;
    	if (divisoesSelecionadas === 0) {
      	msgBox.textContent = "Por favor, selecione pelo menos uma divisão.";
      	msgBox.className = "msg error";
      	msgBox.style.display = "block";
      	return;
    	}
    	const submitButton = form.querySelector('button[type="submit"]');
    	submitButton.textContent = 'Enviando...';
    	submitButton.disabled = true;
  	  const formData = new FormData(form);
  	  fetch(scriptURL, { method: "POST", body: formData })
    	.then(response => response.json())
    	.then(data => {
      	if (data.result === "success") {
        	msgBox.textContent = data.message;
        	msgBox.className = "msg success";
        	form.reset();
      	} else {
        	throw new Error(data.message || 'Falha na resposta do servidor.');
      	}
    	})
    	.catch(error => {
    	  msgBox.textContent = "Erro ao enviar inscrição: " + error.message;
    	  msgBox.className = "msg error";
    	})
    	.finally(() => {
    	  msgBox.style.display = "block";
    	  submitButton.textContent = 'Enviar Inscrição';
    	  submitButton.disabled = false;
    	  setTimeout(() => { msgBox.style.display = "none"; }, 5000);
    	});
  	});
  	const checkboxesDivisao = document.querySelectorAll('input[name="divisao"]');
  	const maxSelecoes = 2;
  	checkboxesDivisao.forEach(checkbox => {
    	checkbox.addEventListener('change', () => {
      	const selecionados = document.querySelectorAll('input[name="divisao"]:checked').length;
      	if (selecionados > maxSelecoes) {
        	alert(`Você pode selecionar no máximo ${maxSelecoes} divisões.`);
        	checkbox.checked = false;
      	}
    	});
  	});
  	const posterImg = document.getElementById('poster-campeonato');
  	posterImg.onerror = function() {
  	  const imageContainer = document.querySelector('.card-image');
  	  if(imageContainer) {
    	  imageContainer.style.display = 'none';
    	}
  	};
  </script>
</body>
</html>
